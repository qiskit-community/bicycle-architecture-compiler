# IBM Pauli-based computation

## Installation

```sh
shell> cargo build --release
```

### Dependencies

Dependencies not availble via `pip` or `cargo`.

* `jq` - commandline JSON processor

### Optional dependencies

* You must have installed either `python3` or GNU `parallel` in order to
  run [./scripts/generate_data.sh](./scripts/generate_data.sh).

### Gridsynth
For synthesizing rotations by angles other than $\pm\pi/4$,
please ensure that a `python` executable is available in your path with the `pygridsynth~=1.1` package installed.
The following command should succeed
```sh
shell> python -m pygridsynth 0.5 1e-3
```
and something like (the exact output may differ)
```
THTHTSHTHTHTHTHTSHTHTHTHTSHTHTSHTSHTSHTSHTSHTSHTSHTHTSHTHTSHTSHTHTSHTSHTHTSHSSWWWWWWW
```

This can be achieved by setting a local virtual environment as follows
```sh
shell> pyenv virtualenv pbc-gross
shell> pyenv local pbc-gross
shell> pip install "pygridsynth~=1.1"
```

## Usage

### Folder map

```
pbc-compiler/
├── docs/                          # Design documents and documentation
├── tests/                         # Test suite
├── examples/                      # Example quantum programs
├── data/                          # Cached data generated by pbc_gross
├── scripts/                       # Scripts for generating data
└── src/
    ├── bicycle_isa/               # Core Bicycle instructions
    ├── benchmark/                 # Random generation of PBC circuits
    ├── gross_code_cliffords/      # Brute force search for Clifford gates
    ├── pbc_gross/                 # PBC to Bicycle ISA compiler
    ├── numerics/                  # Simple noise simulation and stats collections
    └── random_numerics/           # benchmark | pbc_gross | numerics integrated pipeline
```

### PBC Compiler
The PBC compiler packages are located under `src/`.
There's various packages:

1. `bicycle_isa` define the bicycle instructions, which are used as a shared language.
1. `benchmark` generates random circuits of Pauli-generated rotations or measurements.
1. `gross_code_cliffords` searches & builds a table to implement Clifford gates on Gross and Two Gross codes using the least rotations.
1. `pbc_gross` the main compiler that takes in a PBC circuit and outputs a circuit using bicycle instructions.
1. `numerics` adds timing information and collects data about the compiled circuits.
1. `random_numerics` a wrapper package for collecting data faster (basically runs `cargo run --package benchmark <args> | cargo run --package pbc_gross <args> | cargo run --package numerics <args>` without (de)serialization overhead).

Each package has more info in their respective READMEs.

### Installation

```sh
shell> cargo build

shell> python -m venv venv
shell> source venv/bin/activate
shell> pip install -e .
```

### Crate Dependencies
```
bicycle_isa v0.0.1

gross_code_cliffords v0.0.1
└── bicycle_isa v0.0.1

benchmark v0.0.1
├── bicycle_isa v0.0.1
└── pbc_gross v0.0.1

pbc_gross v0.0.1
├── bicycle_isa v0.0.1
└── gross_code_cliffords v0.0.1

numerics v0.0.1
├── benchmark v0.0.1
├── bicycle_isa v0.0.1
└── pbc_gross v0.0.1

random_numerics v0.0.1
├── benchmark v0.0.1
├── bicycle_isa v0.0.1
├── gross_code_cliffords v0.0.1
└── pbc_gross v0.0.1
```

### Development

#### Testing

To test in release mode try this
```sh
shell> cargo test -r
```

The script [./scripts/local_QA.sh](./scripts/local_QA.sh) runs quality assurance tests locally.
This includes test, rustfmt, and clippy.

The tests run almost twice as fast if you use `nextest`.
You can installl nextest like this
```sh
shell> cargo install cargo-binstall
shell> cargo binstall cargo-nextest --secure
```

The script [./scripts/local_QA.sh](./scripts/local_QA.sh) will use `nextest` if it is
installed.
